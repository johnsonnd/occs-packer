---

- hosts: all
  gather_facts: true
  become: true

  vars:
    nodejs_version: "6.2.0"
    appadmin_include_node: true
    appadmin_node_path: /opt/node/bin

    splunk_forwarder_indexer: splunk1.occs-cloud.local
    splunk_forwarder_index: web-access
    splunk_forwarder_logs:
      - path: /var/log/httpd/access_log
      - path: /var/log/httpd/error_log
        index: web-errors
      - path: /var/log/messages
        index: messages
      - path: /var/log/secure
        index: secure

    awslogs_region: us-east-1
    awslogs_logs:
     - file: /var/log/httpd/access_log
       format: "%d/%b/%Y:%H:%M:%S %z"
       time_zone: "UTC"
       initial_position: "end_of_file"
       group_name: Apache-Logs
       stream_name: access-logs

     - file: /var/log/httpd/error_log
       format: "%d %b %y %H:%M:%S.%f"
       time_zone: "UTC"
       initial_position: "end_of_file"
       group_name: Apache-Logs
       stream_name: error-logs

  roles:
    # Test roles for ruby AMI
    - occsab-appadmin
    - occsab-httpd
    - occsab-node
    - ansible-awslogs
    - splunk-forwarder
