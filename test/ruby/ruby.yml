---

- hosts: all
  gather_facts: true
  become: true

  vars:
    ruby_version: "2.3"
    ruby_devel: True
    appadmin_include_ruby: yes
    appadmin_ruby_path: /opt/rh/rh-ruby23/enable

    awslogs_region: us-east-1
    awslogs_logs:
     - file: /var/log/httpd/access_log
       format: "%d/%b/%Y:%H:%M:%S %z"
       time_zone: "UTC"
       initial_position: "end_of_file"
       group_name: 'httpd-access-log'
       stream_name: '{instance_id}-access'

     - file: /var/log/httpd/error_log
       format: "%d %b %y %H:%M:%S.%f"
       time_zone: "UTC"
       initial_position: "end_of_file"
       group_name: 'httpd-access-log'
       stream_name: '{instance_id}-error'

     - file: /var/log/messages
       format: "%b %d %H:%M:%S"
       time_zone: "LOCAL"
       initial_position: "start_of_file"
       group_name: 'var-log-messages'
       stream_name: '{instance_id}'

     - file: /var/log/secure
       format: "%b %d %H:%M:%S"
       time_zone: "LOCAL"
       initial_position: "start_of_file"
       group_name: 'var-log-secure'
       stream_name: '{instance_id}'

  roles:
    # Test roles for ruby AMI
    - occsab-appadmin
    - occsab-httpd
    - occsab-passenger
    - occsab-ruby
    - occs-awslogs
